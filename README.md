# ECT Image Reconstruction Methods

This project contains **two complementary methods** for Electrical Capacitance Tomography (ECT) image reconstruction:

1. **LBP-based Imaging**  
   - Generates initial images from raw ECT sensor data using **Linear Back Projection (LBP)**.  
   - Produces normalized, Gaussian-smoothed 1D/2D images.  
   - Can be used as input for further CNN-based reconstruction, or standalone for visualization.

2. **CNN2D Autoencoder**  
   - Reconstructs/enhances images using a **2D Convolutional Autoencoder**.  
   - Accepts **LBP-generated images** as input.  
   - Can also directly use **precomputed LBP images provided in the dataset**, bypassing the need to run LBP each time.

---

## ðŸ‘‚ Project Structure

```
project_root/
â”‚â”€â”€ lbp/                       # LBP module
â”‚   â”œâ”€â”€ lbp.py                  # LBP imaging functions
â”‚   â””â”€â”€ README.md               # LBP usage instructions
â”‚
â”‚â”€â”€ cnn2d/                     # CNN2D autoencoder module
â”‚   â”œâ”€â”€ dataset_processing.py  # Prepare dataset (imgs/, imgs2/, labels/)
â”‚   â”œâ”€â”€ dataset.py              # PyTorch Dataset definition
â”‚   â”œâ”€â”€ dataloader.py           # Stratified DataLoader split (train/test)
â”‚   â”œâ”€â”€ cnn_2d.py               # CNN2D autoencoder network
â”‚   â”œâ”€â”€ train.py                # Training script
â”‚   â”œâ”€â”€ evaluate.py             # Evaluation script
â”‚   â”œâ”€â”€ checkpoints/            # Saved model weights (after training)
â”‚   â”œâ”€â”€ imgs/                   # Contact images (generated by running dataset_processing.py)
â”‚   â”œâ”€â”€ imgs2/                  # Non-contact images (generated by running dataset_processing.py)
â”‚   â”œâ”€â”€ labels/                 # Shared labels by shape (generated by running dataset_processing.py)
â”‚   â””â”€â”€ README.md               # CNN2D usage instructions
â”‚
â””â”€â”€ README.md                   # Root documentation (this file)
```

---

## ðŸ”¹ Usage Overview

### 1. LBP Imaging

- Input: raw ECT data + background + sensitivity matrix  
- Output: normalized LBP images  
- Example:
```bash
python lbp/lbp.py
```

### 2. CNN2D Autoencoder

- Input: **LBP-generated images**  
- Output: reconstructed/enhanced ECT images  
- Can use either:
  1. **LBP run-on-the-fly**  
  2. **Precomputed LBP images** from the dataset (no need to regenerate LBP each time)

- Example:
```bash
python cnn2d/dataset_processing.py
python cnn2d/train.py
python cnn2d/evaluate.py
```

---

## ðŸ“Š Notes

- The CNN pipeline is **modular**: you can plug in other networks (U-Net, ResNet AE) with the same LBP inputs.  
- `imgs/` vs. `imgs2/` can be toggled for **contact/non-contact experiments**.  
- Precomputed LBP images **accelerate training and evaluation** while preserving reconstruction quality.

---

If you have questions or suggestions, feel free to open an issue or contact the author.

